import { z } from "zod"

const severityEnum = z.enum(["Critical", "High", "Medium", "Low"])
const statusEnum = z.enum(["Open", "Triaged", "Patched", "Ignored"])

export const updateVulnerabilitySchema = z.object({
  id: z.string().uuid("Invalid vulnerability ID"),
  status: statusEnum.optional(),
  remediation_notes: z.string().optional(),
  assigned_to: z.string().uuid("Invalid user ID").nullable().optional(),
})

export const createVulnerabilitySchema = z.object({
  component_id: z.string().uuid("Invalid component ID"),
  cve_id: z.string().min(1, "CVE ID is required"),
  severity: severityEnum,
  status: statusEnum.optional().default("Open"),
  remediation_notes: z.string().nullable().optional(),
  assigned_to: z.string().uuid("Invalid user ID").nullable().optional(),
})

export type UpdateVulnerabilityInput = z.infer<typeof updateVulnerabilitySchema>
export type CreateVulnerabilityInput = z.infer<typeof createVulnerabilitySchema>
