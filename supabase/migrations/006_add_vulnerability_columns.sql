-- Add missing columns to vulnerabilities table

-- Add assigned_to column if it doesn't exist
DO $$
BEGIN
  IF NOT EXISTS (
    SELECT 1 FROM information_schema.columns
    WHERE table_name = 'vulnerabilities' AND column_name = 'assigned_to'
  ) THEN
    ALTER TABLE vulnerabilities ADD COLUMN assigned_to UUID REFERENCES auth.users(id);
  END IF;
END $$;

-- Add remediation_notes column if it doesn't exist
DO $$
BEGIN
  IF NOT EXISTS (
    SELECT 1 FROM information_schema.columns
    WHERE table_name = 'vulnerabilities' AND column_name = 'remediation_notes'
  ) THEN
    ALTER TABLE vulnerabilities ADD COLUMN remediation_notes TEXT;
  END IF;
END $$;
